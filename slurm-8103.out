cuda:0
Calling ... 1
test/validation split val: 0.10
{'input_channels': 4, 'use_embeddings': False, 'embd_window': 5, 'embd_size': 50, 'embd_kmersize': 3, 'num_multiheads': 8, 'singlehead_size': 64, 'multihead_size': 100, 'use_pooling': False, 'pooling_val': 4, 'readout_strategy': 'bspline', 'use_RNN': False, 'RNN_hiddensize': 100, 'use_CNN': True, 'CNN1_useexponential': False, 'use_posEnc': False, 'CNN_filters': [200, 200], 'CNN_filtersize': [13, 13], 'use_CNNpool': False, 'CNN_poolsize': 4, 'CNN_padding': 0, 'get_CNNout': True, 'get_seqs': True, 'get_pattn': True, 'batch_size': 256, 'num_epochs': 60, 'relativeAttn': False, 'Learnable_relativeAttn': False, 'mixed_attn': False, 'mixed_attn_config': '0.25', 'sqrt_dist': False, 'num_attnlayers': 2, 'entropy_loss': False, 'entropy_reg_value': '0.01', 'residual_connection': True, 'multiple_linear': False, 'exp_name': 'arabidopsis', 'cnn_attention_block': False, 'linear_layer_size': 100}
600 588
Loaded model for finetunig...
█ |----------------------------------------| 0.00% [0/60 00:00<?]Train Results (Loss and AUC):  0.422163639130167 0.841107311320045
Best Validation Loss: 0.455 and AUC: 0.81 

Epoch-1 lr: 0.0001 valid_loss: 0.45478238882841887
 |----------------------------------------| 1.67% [1/60 00:58<57:48]Train Results (Loss and AUC):  0.41785058994808105 0.8441252191893648
Best Validation Loss: 0.454 and AUC: 0.82 

Epoch-2 lr: 0.0001 valid_loss: 0.45420897006988525
 |█---------------------------------------| 3.33% [2/60 01:57<57:00]Train Results (Loss and AUC):  0.41443569405537817 0.8476511980204519
Epoch-3 lr: 0.0001 valid_loss: 0.46683034466372597
 |██--------------------------------------| 5.00% [3/60 02:56<55:53]Train Results (Loss and AUC):  0.410209554461806 0.8507552249229569
Best Validation Loss: 0.451 and AUC: 0.82 

Epoch-4 lr: 0.0001 valid_loss: 0.45087805169600026
 |██--------------------------------------| 6.67% [4/60 03:54<54:49]Train Results (Loss and AUC):  0.40446322736605794 0.8554430878265546
Best Validation Loss: 0.451 and AUC: 0.82 

Epoch-5 lr: 0.0001 valid_loss: 0.45080629487832385
 |███-------------------------------------| 8.33% [5/60 04:53<53:51]Train Results (Loss and AUC):  0.3995188702719872 0.858611624799885
Best Validation Loss: 0.448 and AUC: 0.82 

Epoch-6 lr: 0.0001 valid_loss: 0.44843830002678764
 |████------------------------------------| 10.00% [6/60 05:51<52:45]Train Results (Loss and AUC):  0.397244909279783 0.8611262570169249
Epoch-7 lr: 0.0001 valid_loss: 0.45021475906725283
 |████------------------------------------| 11.67% [7/60 06:49<51:43]Train Results (Loss and AUC):  0.39265878379624775 0.8642371856896189
Epoch-8 lr: 0.0001 valid_loss: 0.45805201486304953
 |█████-----------------------------------| 13.33% [8/60 07:46<50:31]Train Results (Loss and AUC):  0.38991032225984923 0.8666990392644509
Epoch-9 lr: 0.0001 valid_loss: 0.4574895567364163
 |██████----------------------------------| 15.00% [9/60 08:44<49:32]Train Results (Loss and AUC):  0.3853976956695458 0.8692378275155013
Epoch-10 lr: 0.0001 valid_loss: 0.4577595917163072
 |██████----------------------------------| 16.67% [10/60 09:42<48:33]Train Results (Loss and AUC):  0.3828333696009408 0.871485554122429
Epoch-11 lr: 0.0001 valid_loss: 0.4737651855857284
 |███████---------------------------------| 18.33% [11/60 10:38<47:24]Train Results (Loss and AUC):  0.37869837572317167 0.8748152527403851
Epoch-12 lr: 1e-05 valid_loss: 0.46603555149502224
 |████████--------------------------------| 20.00% [12/60 11:35<46:22]Train Results (Loss and AUC):  0.3667224848494283 0.8828904876840857
Epoch-13 lr: 1e-05 valid_loss: 0.4634977303169392
 |████████--------------------------------| 21.67% [13/60 12:31<45:16]Train Results (Loss and AUC):  0.3642165702833256 0.8846752490112014
Epoch-14 lr: 1e-05 valid_loss: 0.46525912042017337
 |█████████-------------------------------| 23.33% [14/60 13:31<44:24]Train Results (Loss and AUC):  0.3673301108286414 0.8834189097528395
Epoch-15 lr: 1e-05 valid_loss: 0.4680652877798787
 |██████████------------------------------| 25.00% [15/60 14:27<43:21]Train Results (Loss and AUC):  0.3663403142785802 0.8832186281949552
Epoch-16 lr: 1e-05 valid_loss: 0.462824410310498
 |██████████------------------------------| 26.67% [16/60 15:27<42:29]Train Results (Loss and AUC):  0.36448678556182573 0.88419073040769
Epoch-17 lr: 1e-05 valid_loss: 0.46315274194434836
 |███████████-----------------------------| 28.33% [17/60 16:23<41:28]Train Results (Loss and AUC):  0.3645096520582835 0.8846079525931548
Epoch-18 lr: 1.0000000000000002e-06 valid_loss: 0.4654442822491681
 |████████████----------------------------| 30.00% [18/60 17:20<40:28]Train Results (Loss and AUC):  0.36307658416004807 0.8854977785250149
Epoch-19 lr: 1.0000000000000002e-06 valid_loss: 0.4631875482974229
 |████████████----------------------------| 31.67% [19/60 18:17<39:28]Train Results (Loss and AUC):  0.3620123824043453 0.8858197477174131
Epoch-20 lr: 1.0000000000000002e-06 valid_loss: 0.46318602672329656
 |█████████████---------------------------| 33.33% [20/60 19:14<38:28]Train Results (Loss and AUC):  0.3625909582549977 0.885504320318939
Epoch-21 lr: 1.0000000000000002e-06 valid_loss: 0.46344880428579116
 |██████████████--------------------------| 35.00% [21/60 20:14<37:34]Train Results (Loss and AUC):  0.36193165700760244 0.8861477638251447
Epoch-22 lr: 1.0000000000000002e-06 valid_loss: 0.4644462631808387
 |██████████████--------------------------| 36.67% [22/60 21:13<36:39]Train Results (Loss and AUC):  0.3623255881625162 0.886221270071207
Epoch-23 lr: 1.0000000000000002e-06 valid_loss: 0.46402335663636524
 |███████████████-------------------------| 38.33% [23/60 22:10<35:40]Train Results (Loss and AUC):  0.36179238893616367 0.8859570112945127
Epoch-24 lr: 1.0000000000000002e-07 valid_loss: 0.4635851013439673
 |████████████████------------------------| 40.00% [24/60 23:07<34:41]Train Results (Loss and AUC):  0.3622617721557617 0.885991973867508
Epoch-25 lr: 1.0000000000000002e-07 valid_loss: 0.4667871644099553
 |████████████████------------------------| 41.67% [25/60 24:04<33:41]Train Results (Loss and AUC):  0.36210437237936566 0.8860487605752583
Epoch-26 lr: 1.0000000000000002e-07 valid_loss: 0.4656410151057773
 |█████████████████-----------------------| 43.33% [26/60 25:02<32:44]Train Results (Loss and AUC):  0.36219145364604644 0.8859378345714286
Epoch-27 lr: 1.0000000000000002e-07 valid_loss: 0.46533528467019397
 |██████████████████----------------------| 45.00% [27/60 25:59<31:46]Train Results (Loss and AUC):  0.3619438387418577 0.8860501839597829
Epoch-28 lr: 1.0000000000000002e-07 valid_loss: 0.46429026623566944
 |██████████████████----------------------| 46.67% [28/60 26:56<30:47]Train Results (Loss and AUC):  0.3611507218488505 0.8862445326572805
Epoch-29 lr: 1.0000000000000002e-07 valid_loss: 0.46520903209845227
 |███████████████████---------------------| 48.33% [29/60 27:52<29:48]Train Results (Loss and AUC):  0.36162795609151815 0.8861165764675527
Epoch-30 lr: 1.0000000000000004e-08 valid_loss: 0.46388227961681505
 |████████████████████--------------------| 50.00% [30/60 28:51<28:51]Train Results (Loss and AUC):  0.3617873600391155 0.8859051615811626
Epoch-31 lr: 1.0000000000000004e-08 valid_loss: 0.46471486930493955
 |████████████████████--------------------| 51.67% [31/60 29:49<27:53]Train Results (Loss and AUC):  0.36168321155606303 0.8860381854644513
Epoch-32 lr: 1.0000000000000004e-08 valid_loss: 0.46364157564110225
 |█████████████████████-------------------| 53.33% [32/60 30:46<26:56]Train Results (Loss and AUC):  0.3622534149129626 0.8861385228667907
Epoch-33 lr: 1.0000000000000004e-08 valid_loss: 0.46664806538157994
 |██████████████████████------------------| 55.00% [33/60 31:45<25:59]Train Results (Loss and AUC):  0.36158224044831144 0.886342574754557
Epoch-34 lr: 1.0000000000000004e-08 valid_loss: 0.46372668224352376
 |██████████████████████------------------| 56.67% [34/60 32:45<25:02]Train Results (Loss and AUC):  0.36155132214787983 0.8862315738767252
Epoch-35 lr: 1.0000000000000004e-08 valid_loss: 0.4638484473581667
 |███████████████████████-----------------| 58.33% [35/60 33:43<24:05]Train Results (Loss and AUC):  0.3623569208971212 0.8860072533256722
Epoch-36 lr: 1.0000000000000004e-08 valid_loss: 0.4654290195968416
 |████████████████████████----------------| 60.00% [36/60 34:39<23:06]Train Results (Loss and AUC):  0.3616926503573225 0.8858468454429723
Epoch-37 lr: 1.0000000000000004e-08 valid_loss: 0.46397856650529085
 |████████████████████████----------------| 61.67% [37/60 35:35<22:07]Train Results (Loss and AUC):  0.3620597497678139 0.8862290427456656
Epoch-38 lr: 1.0000000000000004e-08 valid_loss: 0.46396452409249767
 |█████████████████████████---------------| 63.33% [38/60 36:34<21:10]Train Results (Loss and AUC):  0.36206131040210454 0.8860240295127046
Epoch-39 lr: 1.0000000000000004e-08 valid_loss: 0.4643616439015777
 |██████████████████████████--------------| 65.00% [39/60 37:32<20:12]Train Results (Loss and AUC):  0.36284205961115484 0.8860448545069333
Epoch-40 lr: 1.0000000000000004e-08 valid_loss: 0.46713319255246055
 |██████████████████████████--------------| 66.67% [40/60 38:29<19:14]Train Results (Loss and AUC):  0.36109812557697296 0.886246188101801
Epoch-41 lr: 1.0000000000000004e-08 valid_loss: 0.46412585896474345
 |███████████████████████████-------------| 68.33% [41/60 39:27<18:17]Train Results (Loss and AUC):  0.36120346776196655 0.8864063526314445
Epoch-42 lr: 1.0000000000000004e-08 valid_loss: 0.46340340431089755
 |████████████████████████████------------| 70.00% [42/60 40:26<17:20]Train Results (Loss and AUC):  0.36145352211916393 0.8862152741487817
Epoch-43 lr: 1.0000000000000004e-08 valid_loss: 0.4645868848871302
 |████████████████████████████------------| 71.67% [43/60 41:21<16:20]Train Results (Loss and AUC):  0.3609143551526495 0.8863757315840083
Epoch-44 lr: 1.0000000000000004e-08 valid_loss: 0.465543610630212
 |█████████████████████████████-----------| 73.33% [44/60 42:17<15:22]Train Results (Loss and AUC):  0.3616814958937291 0.8860193208159937
Epoch-45 lr: 1.0000000000000004e-08 valid_loss: 0.464388781675586
 |██████████████████████████████----------| 75.00% [45/60 43:14<14:24]Train Results (Loss and AUC):  0.3607601542288149 0.8862850433222247
Epoch-46 lr: 1.0000000000000004e-08 valid_loss: 0.4633707492439835
 |██████████████████████████████----------| 76.67% [46/60 44:12<13:27]Train Results (Loss and AUC):  0.36104532908385906 0.8863875001086251
Epoch-47 lr: 1.0000000000000004e-08 valid_loss: 0.4648840046591229
 |███████████████████████████████---------| 78.33% [47/60 45:07<12:28]Train Results (Loss and AUC):  0.3615720041201148 0.8863864510264624
Epoch-48 lr: 1.0000000000000004e-08 valid_loss: 0.4654245917443876
 |████████████████████████████████--------| 80.00% [48/60 46:06<11:31]Train Results (Loss and AUC):  0.36126149162440235 0.8861905003369532
Epoch-49 lr: 1.0000000000000004e-08 valid_loss: 0.4646555891743413
 |████████████████████████████████--------| 81.67% [49/60 47:05<10:34]Train Results (Loss and AUC):  0.36190574773600404 0.8861599221945236
Epoch-50 lr: 1.0000000000000004e-08 valid_loss: 0.4655842245728881
 |█████████████████████████████████-------| 83.33% [50/60 48:03<09:36]Train Results (Loss and AUC):  0.36100300320996925 0.8864387580675669
Epoch-51 lr: 1.0000000000000004e-08 valid_loss: 0.46440024122043894
 |██████████████████████████████████------| 85.00% [51/60 49:00<08:38]Train Results (Loss and AUC):  0.36217225143607235 0.8859662000714358
Epoch-52 lr: 1.0000000000000004e-08 valid_loss: 0.4628433182283684
 |██████████████████████████████████------| 86.67% [52/60 49:56<07:40]Train Results (Loss and AUC):  0.36230359712676824 0.8860367945044939
Epoch-53 lr: 1.0000000000000004e-08 valid_loss: 0.46415352048697295
 |███████████████████████████████████-----| 88.33% [53/60 50:53<06:43]Train Results (Loss and AUC):  0.3613277002119682 0.8863410614264594
Epoch-54 lr: 1.0000000000000004e-08 valid_loss: 0.46451950128431674
 |████████████████████████████████████----| 90.00% [54/60 51:52<05:45]Train Results (Loss and AUC):  0.36206147396508515 0.8858051066723044
Epoch-55 lr: 1.0000000000000004e-08 valid_loss: 0.4648098448912303
 |████████████████████████████████████----| 91.67% [55/60 52:48<04:48]Train Results (Loss and AUC):  0.3610964451037662 0.8862618841494095
Epoch-56 lr: 1.0000000000000004e-08 valid_loss: 0.46339388633215867
 |█████████████████████████████████████---| 93.33% [56/60 53:46<03:50]Train Results (Loss and AUC):  0.36146166486919207 0.8864696080074844
Epoch-57 lr: 1.0000000000000004e-08 valid_loss: 0.4647069639629788
 |██████████████████████████████████████--| 95.00% [57/60 54:44<02:52]Train Results (Loss and AUC):  0.36226085471995 0.8860287413284054
Epoch-58 lr: 1.0000000000000004e-08 valid_loss: 0.4641469203763538
 |██████████████████████████████████████--| 96.67% [58/60 55:44<01:55]Train Results (Loss and AUC):  0.36212368330485384 0.8860773863795289
Epoch-59 lr: 1.0000000000000004e-08 valid_loss: 0.46547267779156015
 |███████████████████████████████████████-| 98.33% [59/60 56:41<00:57]Train Results (Loss and AUC):  0.36139299891924076 0.8862179900758251
Epoch-60 lr: 1.0000000000000004e-08 valid_loss: 0.4658854228478891
 |████████████████████████████████████████| 100.00% [60/60 57:38<00:00]Test Loss and mean AUC:  0.44550780417063296 0.8244672619069249
Traceback (most recent call last):
  File "/s/chromatin/p/nobackup/Saira/original/satori/satori.py", line 218, in <module>
    main()
  File "/s/chromatin/p/nobackup/Saira/original/satori/satori.py", line 169, in main
    raise Exception("Please extract motifs from the network outputs first (hint: use --motifanalysis)")
Exception: Please extract motifs from the network outputs first (hint: use --motifanalysis)
